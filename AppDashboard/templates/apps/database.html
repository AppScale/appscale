<div class="row-fluid">
    <div class="box gradient">
        <div class="title">
            <h4>
                <span id="icon" class="icon16 icomoon-icon-search-3"></span>
                <span id="title">Database & Application Information</span>
            </h4>
        </div>
        <div class="content">
            <div id="database_info">
                <h4><span class="icon12 icomoon-icon-database"></span>Current Database:</h4>
                <!-- DB Hook -->
                <ul class="unstyled">
                    <li id="db-img"><span class="icon16 icomoon-icon-arrow-right-2"></span><strong>Powered by
                        {% if dbinfo['table'] == 'cassandra' %}
                        <img id="Cassandra" src="/images/cassandra.jpg" alt="Cassandra"/>
                        {% elif dbinfo['table'] == 'hbase' %}
                        <img id="Hbase" src="/images/hbase.png" alt="Hbase"/>
                        {% elif dbinfo['table'] == 'hypertable' %}
                        <img id="Hypertable" src="/images/hypertable.jpg" alt="Hypertable">
                        {% endif %}
                    </strong></li>
                    <br />
                    <li><span class="icon16 icomoon-icon-arrow-right-2"></span>Data is replicated <strong>{{ dbinfo['replication'] }}</strong> times.</li>
                </ul>
                <hr/>
                <div id='application_info'>
                    <h4><span class="icon12 icomoon-icon-cube"></span>Current Applications Deployed:</h4>
                    <!-- App Info Hook -->
                    <ul class="unstyled">
                        {% if apps|length == 0 %}
                        <li><span class="icon16 icomoon-icon-arrow-right-2"></span><a class="disabled btn">None Deployed</a></li>
                        {% else %}
                        {% for app_name in apps.keys()|sort %}
                        <li><span class="icon16 icomoon-icon-arrow-right-2"></span>
                            {% if apps[app_name] %}
                            <a class="btn" href="{{ apps[app_name][0] }}" target="_blank">{{ app_name }}</a>
                            <a class="btn" href="{{ apps[app_name][1] }}" target="_blank">https-{{ app_name }}</a>
                            {% else %}
                            <a class="btn disabled">{{ app_name }} (loading)</a>
                            {% endif %}
                        </li>
                        {% endfor %}
                        {% endif %}
                    </ul></div>
                <script>
                                       window.setInterval(function() {
                                         $.ajax({
                                           url: "/apps/json"
                                         }).done(function(encoded_app_info) {
                                           apps = JSON.parse(encoded_app_info);

                                           // update our divs accordingly
                                           $('#application_info').empty();
                                           apps_html = '<h4><span class="icon12 icomoon-icon-cube"></span>Current Applications Deployed:</h4>';
                                           apps_html += '<ul class="unstyled">';
                                           if (jQuery.isEmptyObject(apps)) {
                                             apps_html += '<li><span class="icon16 icomoon-icon-arrow-right-2"></span><a class="disabled btn">None Deployed</a></li>';
                                           } else {
                                             // get a list of sorted keys, so that we can present the app names in sorted order
                                             keys = []
                                             for (var key in apps) {
                                               keys.push(key)
                                             }
                                             sorted_keys = keys.sort();

                                             for (var index in sorted_keys) {
                                               key = sorted_keys[index];
                                               apps_html += '<li><span class="icon16 icomoon-icon-arrow-right-2"></span>';
                                               if (apps[key] == null) {
                                                 apps_html += '<a class="btn disabled">' + key + ' (loading)</a>';
                                               } else {
                                                 apps_html += '<a class="btn" href="' + apps[key][0] + '" target="_blank">' + key + '</a> ';
                                                 apps_html += '<a class="btn" href="' + apps[key][1] + '" target="_blank">' +'https-'+ key + '</a>';
                                               }
                                               apps_html += '</li>';
                                             }
                                           }
                                           apps_html += '</ul>'
                                           $('#application_info').html(apps_html);
                                         });
                                       }, 10000);
                                     </script>
            </div>
        </div>

    </div><!-- End .box -->
</div>